# 网络系统管理

## 一、系统安装及初始化

```
用户：<根据样题要求>
密码：<根据样题要求>

其他：略。
```

## 二、配置CentOS和UOS本地源及拓展包

### 2-1、分别修改配置文件

```bash
vim /etc/ssh/sshd_config

Port 22						#取消注释
PermitRootLogin yes			#取消注释，某些系统需要稍作修改，<yes>
PubkeyAuthentication yes	#取消注释，<可选>
```

### 2-2UOS配置本地源

#### 2-2-1、UOS的额外拓展包和ISO本地源配置

```bash
vim /etc/apt/sources.list

## Generated by deepin-installer
#deb https://enterprise-packages.chinauos.com/server-enterprise fou/1040 main contrib non-free									#注释该行配置，并添加下面两条配置
#deb-src https://enterprise-packages.chinauos.com/server-enterprise fou/1040 main contrib non-free

deb [trusted=yes] file:///media/cdrom fou main		#添加的配置
deb [trusted=yes] file:/mnt/packs ./				#添加的配置
```

#### 2-2-2、另外操作

```bash
vim /etc/apt/sources.list.d/appstore.list

#注释该文件里的内容
```

#### 2-2-3、UOS的本地镜像源的操作

```bash
mkdir -r /media/cdrom
vim /etc/fstab
	/dev/cdrom /media/cdrom iso9660 defaults 0 0 		#添加该代码，以实现自动挂载CDROM到/media/cdrom

mount -a
```

### 2-3CentOS配置本地yum源

#### 2-3-1、配置本地yum源

```bash
mkdir -p /media/cdrom
mount /dev/cdrom /mdeia/cdrom 						#手动挂载一次镜像到/media/cdrom
rm -rf /etc/yum.repos.d/*							#删除所有用不上的repo
touch /etc/yum.repos.d/local.repo
vim /etc/yum.repos.d/local.repo

[local]
name=localyum
baseurl=file:///media/cdrom
gpgcheck=0
enabled=1

[other]
name=other
baseurl=file:///mnt/package
gpgcheck=0
enabled=1
```

#### 2-3-2、额外操作

```bash
mkdir -p /media/cdrom								#如果操作过可跳过
vim /etc/fstab
	/dev/cdrom /media/cdrom iso9660 defaults 0 0	#添加此行以实现自动挂载CDROM

mount -a
yum clean all
yum makecache
```

## 三、服务配置部分

#### 1、配置时区 CST + 8

##### UOS

```bash
dpkg-reconfigure tzdata

#选择 Asia
#再选 Shanghai
```

##### CentOS

```bash
cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

#回车输入：y
```

#### 2、登录欢迎语

```
*********************************
	ChinaSkills 2023–CSK
		Module C Linux

		>>hostname<<
	>>System Version<<
		>> TIME <<
*********************************
```

```bash
#OS/System Version查看
cat /etc/os-release			#UOS
cat /etc/redhat-release		#CentOS
```

```bash
#UOS
echo "" > /etc/motd								#清空登录所弹出的提示
touch .hushlogin
vim /etc/profile.d/login.sh 
<
#!/bin/bash
time=$(date)
name=$(hostname)
echo "****************************************"
echo "        ChinaSkills 2024 - CSK"
echo "            Module C Linux"
echo " "
echo "    >>$name<<"
echo "       >>UnionTech OS Server 20<<"
echo ">>$time<<"
echo "****************************************"
>
```

```bash
#CentOS
touch .hushlogin
vim /etc/profile.d/login.sh
>
#!/bin/bash
time=$(date)
name=$(hostname)
echo "****************************************"
echo "        ChinaSkills 2024 - CSK"
echo "            Module C Linux"
echo " "
echo "    >>$name<<"
echo "   >>CentOS Linux release 7.9.2009<<"
echo ">>$time<<"
echo "****************************************"
>
```

### 四、前期准备

```bash
#CentOS
systemctl stop firewalld
setenforce 0
vim /etc/sysconfig/selinux

SELINUX=enforcing
修改为
SELINUX=disabled

#IP地址配置：略
#配置完全限定域名等
```

### 五、服务部署

#### IspSrv DHCP服务

```bash
apt -y install isc-dhcp-server
#首先配置DHCP服务器使用的网卡<如:ens36>的静态IP地址
vim /etc/defaults/isc-dhcp-server
<
INTERFACESv4="ens36"
>
vim /etc/dhcp/dhcp.conf
<
subnet 81.6.63.0 netmask 255.255.255.0 {
	range 81.6.63.110 81.6.63.190;
	option domain-name-servers 81.6.63.100;
	option domain-name "chinaskills.cn";
	option routers 81.6.63.254;
	default-lease-time 600;
	max-lease-time 7200;
}
>
```

IspSrv Web Nginx+FastCGI-PHP服务

```bash
mkdir -p /mut/crypt
apt -y install nginx php7.3-fpm php7.3-cli php7.3
vim /etc/nginx/sites-enabled/default
:21,71y #复制21行到71行
vim /etc/nginx/conf.d/ispweb.conf
#粘贴上面复制的内容<P键>，然后按照题意修改
server {
        listen 80;
        root /mut/crypt;
        index index.php
        server_name _;
        location / {
                try_files $uri $uri/ =404;
        }
        location ~ \.php$ {
                include snippets/fastcgi-php.conf;
                fastcgi_pass unix:/run/php/php7.3-fpm.sock;
        }
        #location ~ /\.ht {
        #       deny all;
        #}
}
echo "<?php echo "Welcome to 2025 Computer Network Application contest!" ?> " > /mut/crypt/index.php
systemctl start nginx php7.3-fpm
#OutsideCli访问测试服务器是否生效
```

